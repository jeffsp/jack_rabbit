<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>Jack Rabbit: test_raster.cc</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />



</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">Jack Rabbit
   
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<div class="title">test_raster.cc</div>  </div>
</div><!--header-->
<div class="contents">
<p>Raster test suite</p>
<div class="fragment"><pre class="fragment">





<span class="preprocessor">#include &quot;<a class="code" href="raster_8h.html" title="raster container adapter">raster.h</a>&quot;</span>
<span class="preprocessor">#include &quot;<a class="code" href="subscript__function_8h.html" title="functions that use raster subscripts">subscript_function.h</a>&quot;</span>
<span class="preprocessor">#include &quot;verify.h&quot;</span>
<span class="preprocessor">#include &quot;<a class="code" href="subregion__algo_8h.html" title="subregion algorithms">subregion_algo.h</a>&quot;</span>
<span class="preprocessor">#include &lt;algorithm&gt;</span>
<span class="preprocessor">#include &lt;cmath&gt;</span>
<span class="preprocessor">#include &lt;complex&gt;</span>
<span class="preprocessor">#include &lt;iostream&gt;</span>
<span class="preprocessor">#include &lt;list&gt;</span>
<span class="preprocessor">#include &lt;numeric&gt;</span>
<span class="preprocessor">#include &lt;vector&gt;</span>

<span class="keyword">using namespace </span>horny_toad;
<span class="keyword">using namespace </span>jack_rabbit;
<span class="keyword">using namespace </span>std;

<span class="keyword">template</span>&lt;<span class="keyword">typename</span> T,<span class="keywordtype">size_t</span> ROWS,<span class="keywordtype">size_t</span> COLS&gt;
<span class="keywordtype">void</span> test_constructors ()
{
    <span class="comment">// default ctor</span>
    <a name="_a0"></a><a class="code" href="classjack__rabbit_1_1raster.html" title="raster container adapter">raster&lt;T&gt;</a> a;
    VERIFY (a.<a name="a1"></a><a class="code" href="classjack__rabbit_1_1raster.html#ae2413bcacd051516bf180118ddc73cb2" title="Indicates if the raster has a zero dimension.">empty</a> ());
    <span class="comment">// size ctor</span>
    <a class="code" href="classjack__rabbit_1_1raster.html" title="raster container adapter">raster&lt;T&gt;</a> b (ROWS, COLS);
    VERIFY (b.back () == T ());
    VERIFY (b.front () == T ());
    <span class="comment">// size ctor</span>
    <a class="code" href="classjack__rabbit_1_1raster.html" title="raster container adapter">raster&lt;T&gt;</a> c (ROWS, COLS, T (1));
    VERIFY (c.back () == T (1));
    VERIFY (c.front () == T (1));
    <span class="comment">// copy ctor</span>
    <a class="code" href="classjack__rabbit_1_1raster.html" title="raster container adapter">raster&lt;T&gt;</a> d (c);
    VERIFY (d.back () == T (1));
    VERIFY (d.front () == T (1));
    <span class="comment">// copy ctor</span>
    vector&lt;T&gt; v (ROWS * COLS + 1);
    <a class="code" href="classjack__rabbit_1_1raster.html" title="raster container adapter">raster&lt;T&gt;</a> e (ROWS, COLS, v);
    VERIFY (e.<a name="a2"></a><a class="code" href="classjack__rabbit_1_1raster.html#a549a687ea7a4fb2f30bb277b328cfa8d" title="Get number of elements in the raster.">size</a> () == ROWS * COLS);
    <span class="comment">// copy ctor</span>
    <a class="code" href="classjack__rabbit_1_1raster.html" title="raster container adapter">raster&lt;T&gt;</a> f (ROWS, COLS, 9);
    <a class="code" href="classjack__rabbit_1_1raster.html" title="raster container adapter">raster&lt;double&gt;</a> g (f);
    VERIFY (g.<a name="a3"></a><a class="code" href="classjack__rabbit_1_1raster.html#a549a687ea7a4fb2f30bb277b328cfa8d" title="Get number of elements in the raster.">size</a> () == ROWS * COLS);
    VERIFY (g.<a name="a4"></a><a class="code" href="classjack__rabbit_1_1raster.html#ad4422fa7ab1a7f5ecc9a7e91237f7f74" title="Element access.">front</a> () == 9);
    VERIFY (g.<a name="a5"></a><a class="code" href="classjack__rabbit_1_1raster.html#a5b20c0962edc0226a35d153a6f872c4a" title="Element access.">back</a> () == 9);
    <a class="code" href="classjack__rabbit_1_1raster.html" title="raster container adapter">raster&lt;T&gt;</a> h (ROWS*COLS);
    VERIFY (h.size () == ROWS*COLS);
    VERIFY (h.rows () == ROWS*COLS);
    VERIFY (h.cols () == 1);
}

<span class="keyword">template</span>&lt;<span class="keyword">typename</span> T,<span class="keywordtype">size_t</span> ROWS,<span class="keywordtype">size_t</span> COLS&gt;
<span class="keywordtype">void</span> test_const_ops ()
{
    <a class="code" href="classjack__rabbit_1_1raster.html" title="raster container adapter">raster&lt;T&gt;</a> a;
    VERIFY (a.<a class="code" href="classjack__rabbit_1_1raster.html#ae2413bcacd051516bf180118ddc73cb2" title="Indicates if the raster has a zero dimension.">empty</a> ());
    <a class="code" href="classjack__rabbit_1_1raster.html" title="raster container adapter">raster&lt;T&gt;</a> b (ROWS, COLS);
    <span class="comment">// size, dimensions, capacity, reserve</span>
    VERIFY (b.size () == ROWS * COLS);
    VERIFY (b.rows () == ROWS);
    VERIFY (b.cols () == COLS);
    VERIFY (b.max_size () &gt;= b.size ());
    VERIFY (b.capacity () &gt;= b.size ());
    <a class="code" href="classjack__rabbit_1_1raster.html" title="raster container adapter">raster&lt;T&gt;</a> c (ROWS, COLS);
    c.reserve (ROWS*2, COLS*2);
    VERIFY (c.size () == b.size ());
    c.reserve (ROWS*3 * COLS*3);
    VERIFY (c.size () == b.size ());
    b.assign (1);
    c.assign (1);
    <span class="comment">// relational ops</span>
    VERIFY (b == c);
    b.back () = 0;
    VERIFY (b != c);
    <a class="code" href="classjack__rabbit_1_1raster.html" title="raster container adapter">raster&lt;T&gt;</a> d (ROWS, COLS);
    <a class="code" href="classjack__rabbit_1_1raster.html" title="raster container adapter">raster&lt;T&gt;</a> e (COLS, ROWS);
    VERIFY (d != e);
    <span class="comment">// indexing</span>
    <a class="code" href="classjack__rabbit_1_1raster.html" title="raster container adapter">raster&lt;T&gt;</a> f (ROWS, COLS);
    VERIFY (f.row (f.begin ()) == 0);
    VERIFY (f.row (f.begin () + 1) == 0);
    VERIFY (f.row (f.end () - 1) == ROWS - 1);
    VERIFY (f.row (f.end ()) == ROWS);
    VERIFY (f.col (f.begin ()) == 0);
    VERIFY (f.col (f.begin () + 1) == 1);
    VERIFY (f.col (f.end () - 1) == COLS - 1);
    VERIFY (f.col (f.end ()) == 0); <span class="comment">// not COLS</span>
    <span class="comment">// subregion creation</span>
    <a name="_a6"></a><a class="code" href="structjack__rabbit_1_1subregion.html" title="Rectangular subregion.">subregion</a> s = f.sub (-1, -1, ROWS - 1, COLS - 1);
    VERIFY (s.<a name="a7"></a><a class="code" href="structjack__rabbit_1_1subregion.html#a9c52041a3907247ad4f342f183cfe1bb" title="Subscript of starting element.">r</a> == 0);
    VERIFY (s.<a name="a8"></a><a class="code" href="structjack__rabbit_1_1subregion.html#a909adb8c854031fdc15851046e451993" title="Subscript of starting element.">c</a> == 0);
    VERIFY (s.<a name="a9"></a><a class="code" href="structjack__rabbit_1_1subregion.html#a1cf6ddc9bd7d8a96b0080b55043ab2c0" title="Dimensions of the subregion.">rows</a> == ROWS - 2);
    VERIFY (s.<a name="a10"></a><a class="code" href="structjack__rabbit_1_1subregion.html#ac43d868f1566ddf6947f0d4b3379c3f7" title="Dimensions of the subregion.">cols</a> == COLS - 2);
    s = f.sub (1, 1, ROWS, COLS);
    VERIFY (s.<a class="code" href="structjack__rabbit_1_1subregion.html#a9c52041a3907247ad4f342f183cfe1bb" title="Subscript of starting element.">r</a> == 1);
    VERIFY (s.<a class="code" href="structjack__rabbit_1_1subregion.html#a909adb8c854031fdc15851046e451993" title="Subscript of starting element.">c</a> == 1);
    VERIFY (s.<a class="code" href="structjack__rabbit_1_1subregion.html#a1cf6ddc9bd7d8a96b0080b55043ab2c0" title="Dimensions of the subregion.">rows</a> == ROWS - 1);
    VERIFY (s.<a class="code" href="structjack__rabbit_1_1subregion.html#ac43d868f1566ddf6947f0d4b3379c3f7" title="Dimensions of the subregion.">cols</a> == COLS - 1);
    s = f.sub (ROWS - 1, COLS - 1, ROWS, COLS);
    VERIFY (s.<a class="code" href="structjack__rabbit_1_1subregion.html#a9c52041a3907247ad4f342f183cfe1bb" title="Subscript of starting element.">r</a> == ROWS - 1);
    VERIFY (s.<a class="code" href="structjack__rabbit_1_1subregion.html#a909adb8c854031fdc15851046e451993" title="Subscript of starting element.">c</a> == COLS - 1);
    VERIFY (s.<a class="code" href="structjack__rabbit_1_1subregion.html#a1cf6ddc9bd7d8a96b0080b55043ab2c0" title="Dimensions of the subregion.">rows</a> == 1);
    VERIFY (s.<a class="code" href="structjack__rabbit_1_1subregion.html#ac43d868f1566ddf6947f0d4b3379c3f7" title="Dimensions of the subregion.">cols</a> == 1);
    s = f.sub (ROWS, COLS, ROWS, COLS);
    VERIFY (s.<a class="code" href="structjack__rabbit_1_1subregion.html#a1cf6ddc9bd7d8a96b0080b55043ab2c0" title="Dimensions of the subregion.">rows</a> == 0);
    VERIFY (s.<a class="code" href="structjack__rabbit_1_1subregion.html#ac43d868f1566ddf6947f0d4b3379c3f7" title="Dimensions of the subregion.">cols</a> == 0);
    s = f.sub (ROWS, COLS - 1, 1, 1);
    VERIFY (s.<a class="code" href="structjack__rabbit_1_1subregion.html#a1cf6ddc9bd7d8a96b0080b55043ab2c0" title="Dimensions of the subregion.">rows</a> == 0);
    VERIFY (s.<a class="code" href="structjack__rabbit_1_1subregion.html#ac43d868f1566ddf6947f0d4b3379c3f7" title="Dimensions of the subregion.">cols</a> == 1);
    s = f.sub (ROWS - 1, COLS, 1, 1);
    VERIFY (s.<a class="code" href="structjack__rabbit_1_1subregion.html#a1cf6ddc9bd7d8a96b0080b55043ab2c0" title="Dimensions of the subregion.">rows</a> == 1);
    VERIFY (s.<a class="code" href="structjack__rabbit_1_1subregion.html#ac43d868f1566ddf6947f0d4b3379c3f7" title="Dimensions of the subregion.">cols</a> == 0);
}

<span class="keyword">template</span>&lt;<span class="keyword">typename</span> T,<span class="keywordtype">size_t</span> ROWS,<span class="keywordtype">size_t</span> COLS&gt;
<span class="keywordtype">void</span> test_assignment ()
{
    <a class="code" href="classjack__rabbit_1_1raster.html" title="raster container adapter">raster&lt;T&gt;</a> a;
    <a class="code" href="classjack__rabbit_1_1raster.html" title="raster container adapter">raster&lt;T&gt;</a> b (ROWS, COLS, 1);
    <a class="code" href="classjack__rabbit_1_1raster.html" title="raster container adapter">raster&lt;T&gt;</a> c (COLS, ROWS, 2);
    <span class="comment">// swap</span>
    swap (a, b);
    VERIFY (a.<a name="a11"></a><a class="code" href="classjack__rabbit_1_1raster.html#ae6856e6b6b72daf79c103b74d5c73917" title="Get dimensions.">rows</a> () == ROWS);
    VERIFY (a.<a name="a12"></a><a class="code" href="classjack__rabbit_1_1raster.html#a93c154e083351197ab9a0bd2522e8fb1" title="Get dimensions.">cols</a> () == COLS);
    VERIFY (a.<a name="a13"></a><a class="code" href="classjack__rabbit_1_1raster.html#ad4422fa7ab1a7f5ecc9a7e91237f7f74" title="Element access.">front</a> () == 1);
    VERIFY (a.<a name="a14"></a><a class="code" href="classjack__rabbit_1_1raster.html#a5b20c0962edc0226a35d153a6f872c4a" title="Element access.">back</a> () == 1);
    VERIFY (b.empty ());
    <span class="comment">// operator=</span>
    a = c;
    VERIFY (a.rows () == c.rows ());
    VERIFY (a.cols () == c.cols ());
    VERIFY (a.front () == 2);
    VERIFY (a.back () == 2);
    <span class="comment">// assign</span>
    a.<a name="a15"></a><a class="code" href="classjack__rabbit_1_1raster.html#a6ac2af650b5d9822f42b2bafd741bb1f" title="Assign all element values.">assign</a> (3);
    VERIFY (a.front () == 3);
    VERIFY (a.back () == 3);
    <span class="comment">// copy assignment</span>
    <a class="code" href="classjack__rabbit_1_1raster.html" title="raster container adapter">raster&lt;T&gt;</a> d (ROWS, COLS, 3);
    <a class="code" href="classjack__rabbit_1_1raster.html" title="raster container adapter">raster&lt;double&gt;</a> e;
    e = d;
    VERIFY (e.<a name="a16"></a><a class="code" href="classjack__rabbit_1_1raster.html#ae6856e6b6b72daf79c103b74d5c73917" title="Get dimensions.">rows</a> () == ROWS);
    VERIFY (e.<a name="a17"></a><a class="code" href="classjack__rabbit_1_1raster.html#a93c154e083351197ab9a0bd2522e8fb1" title="Get dimensions.">cols</a> () == COLS);
    VERIFY (e.<a class="code" href="classjack__rabbit_1_1raster.html#ad4422fa7ab1a7f5ecc9a7e91237f7f74" title="Element access.">front</a> () == 3);
    VERIFY (e.<a class="code" href="classjack__rabbit_1_1raster.html#a5b20c0962edc0226a35d153a6f872c4a" title="Element access.">back</a> () == 3);
}

<span class="keyword">template</span>&lt;<span class="keyword">typename</span> T,<span class="keywordtype">size_t</span> ROWS,<span class="keywordtype">size_t</span> COLS&gt;
<span class="keywordtype">void</span> test_access ()
{
    <span class="comment">// operator[], operator(i,j)</span>
    <a class="code" href="classjack__rabbit_1_1raster.html" title="raster container adapter">raster&lt;T&gt;</a> a (ROWS, COLS, 1);
    VERIFY (&amp;a[0] == &amp;a (0, 0));
    VERIFY (&amp;a[a.size () - 1] == &amp;a (ROWS - 1, COLS - 1));
    <span class="comment">// at</span>
    <span class="keywordtype">bool</span> threw = <span class="keyword">false</span>;
    <span class="keywordflow">try</span> { a (0, 0) = a.at (ROWS - 1, COLS - 1); }
    <span class="keywordflow">catch</span> (...) { threw = <span class="keyword">true</span>; }
    VERIFY (!threw);
    <span class="keywordflow">try</span> { a (0, 0) = a.at (ROWS, COLS); }
    <span class="keywordflow">catch</span> (...) { threw = <span class="keyword">true</span>; }
    VERIFY (threw);
    <span class="comment">// begin, end, front, back</span>
    list&lt;T&gt; b (ROWS * COLS);
    <a name="a18"></a><a class="code" href="namespacejack__rabbit.html#a080eceb7b1e9a81be97490104b62e82a" title="Overload for fast subregion copies.">copy</a> (a.begin (), a.end (), b.begin ());
    VERIFY (b.back () == 1);
    <a class="code" href="classjack__rabbit_1_1raster.html" title="raster container adapter">raster&lt;T&gt;</a> c (ROWS, COLS);
    transform (c.begin (), c.end () - 1,
        c.begin () + 1,
        bind2nd (plus&lt;T&gt; (), 1));
    VERIFY (c.front () == 0);
    VERIFY (c.back () == ROWS * COLS - 1);
    <span class="comment">// rbegin, rend</span>
    <a class="code" href="classjack__rabbit_1_1raster.html" title="raster container adapter">raster&lt;T&gt;</a> d (ROWS, COLS);
    <a class="code" href="namespacejack__rabbit.html#a080eceb7b1e9a81be97490104b62e82a" title="Overload for fast subregion copies.">copy</a> (c.rbegin (), c.rend (), d.begin ());
    VERIFY (d.front () == ROWS * COLS - 1);
    VERIFY (d.back () == 0);
    <span class="comment">// loc</span>
    VERIFY (d.loc (0, 0) == d.begin ());
    VERIFY (d.loc (ROWS - 1, COLS) == d.end ());
}

<span class="keyword">template</span>&lt;<span class="keyword">typename</span> T,<span class="keywordtype">size_t</span> ROWS,<span class="keywordtype">size_t</span> COLS&gt;
<span class="keywordtype">void</span> test_insert_remove ()
{
    <a class="code" href="classjack__rabbit_1_1raster.html" title="raster container adapter">raster&lt;T&gt;</a> a (ROWS, COLS);
    <a class="code" href="classjack__rabbit_1_1raster.html" title="raster container adapter">raster&lt;T&gt;</a> b (a);
    <span class="comment">// clear</span>
    a.clear ();
    VERIFY (a.empty ());
    <span class="comment">// resize</span>
    a.resize (ROWS, COLS);
    VERIFY (a.rows () == ROWS);
    VERIFY (a.cols () == COLS);
    a.resize (ROWS + 1, COLS + 1, 2);
    VERIFY (a.rows () == ROWS + 1);
    VERIFY (a.cols () == COLS + 1);
    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; a.rows (); ++i)
        VERIFY (a (i, COLS) == 2);
    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = 0; j &lt; a.cols (); ++j)
        VERIFY (a (ROWS, j) == 2);
    a.resize (ROWS, COLS);
    VERIFY (a == b);
    <span class="comment">// insert_rows erase_rows</span>
    <span class="keyword">typename</span> raster&lt;T&gt;::iterator iter = a.insert_rows (a.begin (), 2, 10);
    VERIFY (iter == a.<a name="a19"></a><a class="code" href="classjack__rabbit_1_1raster.html#a3f4c5989578287a91a30d5e09dd02c72" title="Iterator access.">begin</a> ());
    VERIFY (a (0, 0) == 10);
    VERIFY (a (1, COLS - 1) == 10);
    VERIFY (a (2, 0) == 0);
    VERIFY (a (2, COLS - 1) == 0);
    iter = a.<a name="a20"></a><a class="code" href="classjack__rabbit_1_1raster.html#aba4f93bdd430c10c914af9ad4d729c4a" title="Erase a row.">erase_row</a> (a.begin ());
    VERIFY (iter == a.<a class="code" href="classjack__rabbit_1_1raster.html#a3f4c5989578287a91a30d5e09dd02c72" title="Iterator access.">begin</a> ());
    VERIFY (a (0, 0) == 10);
    VERIFY (a (1, COLS - 1) == 0);
    iter = a.<a class="code" href="classjack__rabbit_1_1raster.html#aba4f93bdd430c10c914af9ad4d729c4a" title="Erase a row.">erase_row</a> (a.begin ());
    VERIFY (iter == a.<a class="code" href="classjack__rabbit_1_1raster.html#a3f4c5989578287a91a30d5e09dd02c72" title="Iterator access.">begin</a> ());
    VERIFY (a (0, 0) == 0);
    VERIFY (a (0, COLS - 1) == 0);
    iter = a.<a name="a21"></a><a class="code" href="classjack__rabbit_1_1raster.html#ac907ac85a88c783379b65214dc4c2bc3" title="Insert one or more rows.">insert_rows</a> (a.end (), 2, 11);
    VERIFY (&amp;*iter == &amp;a (ROWS, 0));
    VERIFY (a (ROWS - 1, 0) == 0);
    VERIFY (a (ROWS - 1, COLS - 1) == 0);
    VERIFY (a (ROWS, 0) == 11);
    VERIFY (a (ROWS + 1, COLS - 1) == 11);
    iter = a.<a class="code" href="classjack__rabbit_1_1raster.html#aba4f93bdd430c10c914af9ad4d729c4a" title="Erase a row.">erase_row</a> (a.end () - 1);
    VERIFY (a (ROWS, 0) == 11);
    VERIFY (a (ROWS, COLS - 1) == 11);
    iter = a.<a class="code" href="classjack__rabbit_1_1raster.html#aba4f93bdd430c10c914af9ad4d729c4a" title="Erase a row.">erase_row</a> (a.end () - 1);
    VERIFY (a == b);
    <span class="comment">// insert_cols erase_cols</span>
    iter = a.<a name="a22"></a><a class="code" href="classjack__rabbit_1_1raster.html#abf96ab4b21047f8fc29e4c55885199fa" title="Insert one or more columns.">insert_cols</a> (a.begin (), 2, 10);
    VERIFY (iter == a.<a class="code" href="classjack__rabbit_1_1raster.html#a3f4c5989578287a91a30d5e09dd02c72" title="Iterator access.">begin</a> ());
    VERIFY (a (0, 0) == 10);
    VERIFY (a (ROWS - 1, 1) == 10);
    VERIFY (a (0, 2) == 0);
    VERIFY (a (ROWS - 1, 2) == 0);
    iter = a.<a name="a23"></a><a class="code" href="classjack__rabbit_1_1raster.html#a27039cd379b976c054e3ca444eca516d" title="Erase a column.">erase_col</a> (a.begin ());
    VERIFY (iter == a.<a class="code" href="classjack__rabbit_1_1raster.html#a3f4c5989578287a91a30d5e09dd02c72" title="Iterator access.">begin</a> ());
    VERIFY (a (0, 0) == 10);
    VERIFY (a (ROWS - 1, 1) == 0);
    iter = a.<a class="code" href="classjack__rabbit_1_1raster.html#a27039cd379b976c054e3ca444eca516d" title="Erase a column.">erase_col</a> (a.begin ());
    VERIFY (iter == a.<a class="code" href="classjack__rabbit_1_1raster.html#a3f4c5989578287a91a30d5e09dd02c72" title="Iterator access.">begin</a> ());
    VERIFY (a (0, 0) == 0);
    VERIFY (a (ROWS - 1, 0) == 0);
    iter = a.<a class="code" href="classjack__rabbit_1_1raster.html#abf96ab4b21047f8fc29e4c55885199fa" title="Insert one or more columns.">insert_cols</a> (a.end (), 2, 11);
    VERIFY (&amp;*iter == &amp;a (0, COLS));
    VERIFY (a (0, COLS - 1) == 0);
    VERIFY (a (ROWS - 1, COLS - 1) == 0);
    VERIFY (a (0, COLS) == 11);
    VERIFY (a (ROWS - 1, COLS + 1) == 11);
    iter = a.<a class="code" href="classjack__rabbit_1_1raster.html#a27039cd379b976c054e3ca444eca516d" title="Erase a column.">erase_col</a> (a.end () - 1);
    VERIFY (&amp;*iter == &amp;a (0, COLS + 1));
    VERIFY (a (0, COLS) == 11);
    VERIFY (a (ROWS - 1, COLS - 1) == 0);
    iter = a.<a class="code" href="classjack__rabbit_1_1raster.html#a27039cd379b976c054e3ca444eca516d" title="Erase a column.">erase_col</a> (a.end () - 1);
    VERIFY (a == b);
}

<span class="keyword">template</span>&lt;<span class="keyword">typename</span> T,<span class="keywordtype">size_t</span> ROWS,<span class="keywordtype">size_t</span> COLS&gt;
<span class="keywordtype">void</span> test_subregion_iter ()
{
    <a class="code" href="classjack__rabbit_1_1raster.html" title="raster container adapter">raster&lt;T&gt;</a> a (ROWS, COLS, 1);
    <span class="keyword">typename</span> <a name="_a24"></a><a class="code" href="classjack__rabbit_1_1subregion__iter.html" title="raster subregion iterator">raster&lt;T&gt;::subregion_iterator</a> i;
    <span class="comment">// non-edge element subregion</span>
    <a class="code" href="structjack__rabbit_1_1subregion.html" title="Rectangular subregion.">subregion</a> s = a.sub (1, 1, ROWS - 2, COLS - 2);
    <span class="keywordflow">for</span> (i = a.begin (s); i != a.end (s); ++i)
        *i = 0;
    VERIFY (a (0, 0) == 1);
    VERIFY (a (0, COLS - 1) == 1);
    VERIFY (a (ROWS - 1, 0) == 1);
    VERIFY (a (ROWS - 1, COLS - 1) == 1);
    VERIFY (a (1, 1) == 0);
    VERIFY (a (1, COLS - 2) == 0);
    VERIFY (a (ROWS - 2, 1) == 0);
    VERIFY (a (ROWS - 2, COLS - 2) == 0);
    <span class="comment">// subregion_iterator access</span>
    <span class="keyword">typename</span> <a class="code" href="classjack__rabbit_1_1subregion__iter.html" title="raster subregion iterator">raster&lt;T&gt;::subregion_iterator</a> j = a.begin (s);
    VERIFY (a (1, 1) == 0);
    VERIFY (a (1, 2) == 0);
    *j = 1;
    VERIFY (a (1, 1) == 1);
    *++j = 2;
    VERIFY (a (1, 2) == 2);
    <span class="comment">// const_subregion_iterator access</span>
    <span class="keyword">const</span> <a class="code" href="classjack__rabbit_1_1raster.html" title="raster container adapter">raster&lt;T&gt;</a> b (a);
    j = a.begin (s);
    <span class="keyword">typename</span> <a class="code" href="classjack__rabbit_1_1subregion__iter.html" title="raster subregion iterator">raster&lt;T&gt;::const_subregion_iterator</a> k = b.begin (s);
    VERIFY (a (1, 1) == 1);
    *j = *k + 1;
    VERIFY (a (1, 1) == 2);
}

<span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;
<span class="keyword">class </span>Mean
{
    T num;
    T sum;
    <span class="keyword">public</span>:
    Mean () : num (0), sum (0) { }
    <span class="keywordtype">void</span> operator() (<span class="keyword">const</span> T &amp;v) { ++num; sum += v; }
    T operator() () { <span class="keywordflow">return</span> sum / num; }
};

<span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;
<span class="keyword">class </span>Count
{
    <span class="keywordtype">size_t</span> total;
    <span class="keyword">public</span>:
    Count () : total (0) { }
    <span class="keywordtype">void</span> operator() (<span class="keyword">const</span> T &amp;) { ++total; }
    <span class="keywordtype">size_t</span> operator() () { <span class="keywordflow">return</span> total; }
};

<span class="keyword">template</span>&lt;<span class="keyword">typename</span> T,<span class="keywordtype">size_t</span> ROWS,<span class="keywordtype">size_t</span> COLS&gt;
<span class="keywordtype">void</span> test_algorithms ()
{
    <a class="code" href="classjack__rabbit_1_1raster.html" title="raster container adapter">raster&lt;T&gt;</a> a (ROWS, COLS, 10);
    <a class="code" href="structjack__rabbit_1_1subregion.html" title="Rectangular subregion.">subregion</a> all = { 0, 0, ROWS, COLS };
    Mean&lt;T&gt; m = for_each (a.begin (all), a.end (all), Mean&lt;T&gt; ());
    VERIFY (m () == 10);
    Count&lt;T&gt; count = for_each (a.begin (all), a.end (all), Count&lt;T&gt; ());
    VERIFY (count () == ROWS * COLS);
    <span class="keyword">const</span> <a class="code" href="classjack__rabbit_1_1raster.html" title="raster container adapter">raster&lt;T&gt;</a> b (ROWS, COLS, 8);
    <a class="code" href="classjack__rabbit_1_1raster.html" title="raster container adapter">raster&lt;T&gt;</a> c (ROWS, COLS);
    <a class="code" href="structjack__rabbit_1_1subregion.html" title="Rectangular subregion.">subregion</a> s = { 0, 0, ROWS, COLS };
    <a class="code" href="namespacejack__rabbit.html#a080eceb7b1e9a81be97490104b62e82a" title="Overload for fast subregion copies.">copy</a> (b.begin (s), b.end (s), c.begin (s));
    VERIFY (c.front () == 8);
    VERIFY (c.back () == 8);
    <a class="code" href="classjack__rabbit_1_1raster.html" title="raster container adapter">raster&lt;T&gt;</a> d (ROWS, COLS, 0);
    VERIFY (d.front () == 0);
    VERIFY (d.back () == 0);
    <a class="code" href="namespacejack__rabbit.html#a080eceb7b1e9a81be97490104b62e82a" title="Overload for fast subregion copies.">copy</a> (b.begin (), b.end (), d.begin ());
    VERIFY (d.front () == 8);
    VERIFY (d.back () == 8);
}

<span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;
<span class="keyword">struct </span>dist_op0
{
    dist_op0 (<span class="keywordtype">size_t</span> , <span class="keywordtype">size_t</span> ) { }
    T operator() (<span class="keywordtype">size_t</span> r, <span class="keywordtype">size_t</span> c)
    { <span class="keywordflow">return</span> sqrt (static_cast&lt;T&gt; (c * c + r * r)); }
};

<span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;
<span class="keyword">struct </span>dist_op1
{
    dist_op1 (<span class="keywordtype">size_t</span> , <span class="keywordtype">size_t</span> ) { }
    T operator() (<span class="keywordtype">size_t</span> r, <span class="keywordtype">size_t</span> c, <span class="keyword">const</span> T&amp; u)
    { <span class="keywordflow">return</span> u * sqrt (static_cast&lt;T&gt; (c * c + r * r)); }
};

<span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;
<span class="keyword">struct </span>dist_op2
{
    dist_op2 (<span class="keywordtype">size_t</span> , <span class="keywordtype">size_t</span> ) { }
    T operator() (<span class="keywordtype">size_t</span> r, <span class="keywordtype">size_t</span> c, <span class="keyword">const</span> T&amp; u, <span class="keyword">const</span> T&amp; v)
    { <span class="keywordflow">return</span> (u + v) * sqrt (static_cast&lt;T&gt; (c * c + r * r)); }
};

<span class="keyword">template</span>&lt;<span class="keyword">typename</span> T,<span class="keywordtype">size_t</span> ROWS,<span class="keywordtype">size_t</span> COLS&gt;
<span class="keywordtype">void</span> test_functions ()
{
    <span class="comment">// generator</span>
    <a class="code" href="classjack__rabbit_1_1raster.html" title="raster container adapter">raster&lt;T&gt;</a> a (ROWS, COLS);
    generate (a.begin (), a.end (),
        <a name="_a25"></a><a class="code" href="classjack__rabbit_1_1subscript__generator.html" title="Generating subscript function.">subscript_generator&lt;T,dist_op0&gt;</a> (ROWS, COLS));
    VERIFY (a (0, 0) == 0.0);
    VERIFY (a (ROWS - 1, COLS - 1) &gt; ROWS);
    VERIFY (a (ROWS - 1, COLS - 1) &gt; COLS);
    <span class="comment">// unary_function</span>
    <a class="code" href="classjack__rabbit_1_1raster.html" title="raster container adapter">raster&lt;T&gt;</a> b (ROWS, COLS, 1.0);
    transform (b.begin (), b.end (), b.begin (),
        <a name="_a26"></a><a class="code" href="classjack__rabbit_1_1subscript__unary__function.html" title="Unary subscript function.">subscript_unary_function&lt;T,dist_op1&gt;</a> (ROWS, COLS));
    VERIFY (b (0, 0) == 0.0);
    VERIFY (b (ROWS - 1, COLS - 1) &gt; ROWS);
    VERIFY (b (ROWS - 1, COLS - 1) &gt; COLS);
    <a class="code" href="classjack__rabbit_1_1raster.html" title="raster container adapter">raster&lt;T&gt;</a> c0 (ROWS, COLS, 1.0);
    <a class="code" href="classjack__rabbit_1_1raster.html" title="raster container adapter">raster&lt;T&gt;</a> c1 (ROWS, COLS, 1.0);
    <a class="code" href="classjack__rabbit_1_1raster.html" title="raster container adapter">raster&lt;T&gt;</a> c2 (ROWS, COLS, 1.0);
    <span class="comment">// binary_function in a subregion</span>
    <span class="comment">//</span>
    <span class="comment">// non-edge element subregion</span>
    <a class="code" href="structjack__rabbit_1_1subregion.html" title="Rectangular subregion.">subregion</a> s = c0.sub (1, 1, ROWS - 2, COLS - 2);
    transform (c0.begin (s), c0.end (s),
        c1.begin (s), c2.begin (s),
        <a name="_a27"></a><a class="code" href="classjack__rabbit_1_1subscript__binary__function.html" title="Binary subscript function.">subscript_binary_function&lt;T,dist_op2&gt;</a> (s));
    VERIFY (c2 (0, 0) == 1.0);
    VERIFY (c2 (ROWS - 1, 0) == 1.0);
    VERIFY (c2 (0, COLS - 1) == 1.0);
    VERIFY (c2 (ROWS - 1, COLS - 1) == 1.0);
    VERIFY (c2 (1, 1) != 1.0);
    VERIFY (c2 (ROWS - 2, 1) != 1.0);
    VERIFY (c2 (1, COLS - 2) != 1.0);
    VERIFY (c2 (ROWS - 2, COLS - 2) != 1.0);
}

<span class="keyword">template</span>&lt;<span class="keyword">typename</span> T,<span class="keywordtype">size_t</span> ROWS,<span class="keywordtype">size_t</span> COLS&gt;
<span class="keywordtype">void</span> test_copy ()
{
    <a class="code" href="classjack__rabbit_1_1raster.html" title="raster container adapter">raster&lt;T&gt;</a> a (ROWS, COLS, 1);
    <a class="code" href="classjack__rabbit_1_1raster.html" title="raster container adapter">raster&lt;T&gt;</a> b (ROWS, COLS, 0);
    <a class="code" href="namespacejack__rabbit.html#a080eceb7b1e9a81be97490104b62e82a" title="Overload for fast subregion copies.">copy</a> (a.begin (), a.end (), b.begin ());
    VERIFY (b.front () == 1);
    VERIFY (b.back () == 1);
    b.assign (0);
    <a class="code" href="structjack__rabbit_1_1subregion.html" title="Rectangular subregion.">subregion</a> s = { 1, 1, ROWS - 2, COLS - 2 };
    <a class="code" href="namespacejack__rabbit.html#a080eceb7b1e9a81be97490104b62e82a" title="Overload for fast subregion copies.">copy</a> (a.begin (s), a.end (s), b.begin (s));
    VERIFY (b.front () == 0);
    VERIFY (b (1, 0) == 0);
    VERIFY (b (1, 1) == 1);
    VERIFY (b (1, COLS - 1) == 0);
    VERIFY (b (1, COLS - 2) == 1);
    VERIFY (b (ROWS - 2, 0) == 0);
    VERIFY (b (ROWS - 2, 1) == 1);
    VERIFY (b (ROWS - 2, COLS - 1) == 0);
    VERIFY (b (ROWS - 2, COLS - 2) == 1);
    VERIFY (b.back () == 0);
}

<span class="keywordtype">int</span> main ()
{
    <span class="keywordflow">try</span>
    {
        test_constructors&lt;char,19,23&gt; ();
        test_constructors&lt;int,10,10&gt; ();
        test_constructors&lt;float,19,17&gt; ();
        test_const_ops&lt;complex&lt;double&gt;,7,11&gt; ();
        test_assignment&lt;wchar_t,23,32&gt; ();
        test_assignment&lt;unsigned,23,32&gt; ();
        test_access&lt;int,8,9&gt; ();
        test_access&lt;long double,5,6&gt; ();
        test_insert_remove&lt;long,3,5&gt; ();
        test_subregion_iter&lt;int,15,16&gt; ();
        test_subregion_iter&lt;char,128,5&gt; ();
        test_algorithms&lt;int,64,32&gt; ();
        test_algorithms&lt;float,64,32&gt; ();
        test_functions&lt;float,16,17&gt; ();
        test_copy&lt;float,12,21&gt; ();

        <span class="keywordflow">return</span> 0;
    }
    <span class="keywordflow">catch</span> (<span class="keyword">const</span> exception &amp;e)
    {
        cerr &lt;&lt; e.what () &lt;&lt; endl;
        <span class="keywordflow">return</span> -1;
    }
}
</pre></div> </div><!-- contents -->
</div><!-- contents -->


<hr class="footer"/><address class="footer"><small>
Generated on Thu May 22 2014 20:57:31 for Jack Rabbit by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.7.6.1
</small></address>

</body>
</html>
